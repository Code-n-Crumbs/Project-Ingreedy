{% extends "layout.html" %}

{% block title %}Ingreedy{% endblock %}
{% block page %}Ingreedy{% endblock %}


{{ super() }}

{% block content %}

<main style="padding: 20px; font-family: sans-serif;">
    <div style="margin-bottom: 20px;">
        <h1 style="font-size: 1.8rem; margin: 0;">Welcome, {{ current_user.username }}!</h1>
    </div>

    <div style="display: flex; gap: 20px;">

        <!-- Display the list of recipes the user added  -->
        <div class="recipe-list-column">
            <div style="text-align: center;">
                <h2 style="font-size: 1.8rem;">My Recipes</h2>
            </div>
            {% for recipe in recipes %}
                <div style="background: #f0f0f0; padding: 10px; margin-bottom: 10px; border-radius: 6px;">
                    <a href="/user/recipe/{{ recipe.recipe_id }}">{{ recipe.recipe_name }} [{{ recipe.count }}]</a>
                </div>
            {% endfor %}
        </div>

        <!-- Display the recipe selected by the user, the defualt is the first recipe  -->
        <div class="selected-recipe-column">
            {% if selected_recipe %}
                <div style="text-align: center;">
                    <h2 style="font-size: 1.8rem;">{{ selected_recipe.recipe_name }}</h2>
                </div>
                <p><strong>Time Taken:</strong> {{ selected_recipe.total_time_taken }}</p>

                <h5 style="margin-top: 15px;">Ingredients   ({{missing_ing}} missing)</h5>
                <ul>
                    {% for ingredient in ri %}
                        <li>
                            {{ ingredient.ingredient_name }} {% if ingredient.missing %}<span style="color: red;">(missing)</span>{% endif %}
                        </li>
                    {% endfor %}
                </ul>

                <h5 style="margin-top: 15px;">Directions</h5>
                <p>{{ selected_recipe.directions }}</p>
            {% else %}
                <p>Select a recipe to view its details.</p>
            {% endif %}
        </div>

        <!-- Getting user inventory and have a space for entering new ingredients  -->
        <div class="my-inventory">
            <div style="flex: 1; overflow-y: auto;">
                <div style="text-align: center;">
                    <h2 style="font-size: 1.8rem;">My Ingredients</h2>
                </div>
                <ul style="list-style-type: none; padding: 0;  max-height: 340px; overflow-y: auto;">
                    {% for ingredient in ingredients %}
                        <li class="my-inventory-list">
                            {{ ingredient.ingredient_name }}
                            <a href="/ingredient/delete/{{ ingredient.ingredient_id }}" class="delete-ingredient-button">Remove</a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="add-ingredient">
                <form action="/ingredient/add" method="POST" style="display: flex; gap: 5px;">
                    <input type="text" name="ingredient_name" placeholder="Add Ingredient" required style="flex-grow: 1; padding: 5px;">
                    <button type="submit" style="padding: 5px;">+</button>
                </form>
            </div>
        </div>
    </div>
</main>


{% endblock %}
